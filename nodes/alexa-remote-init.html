<script type="text/x-red" data-template-name="alexa-remote-init">
	<div class="form-row">
		<label for="node-input-name"><i class="icon-tag"></i> Name</label>
		<input type="text" id="node-input-name" placeholder="Optional">
	</div>
	<div class="form-row">
		<label for="node-input-account"><i class="fa fa-amazon"></i> Account</label>
		<input id="node-input-account">
	</div>
	<div class="form-row">
		<label for="node-input-option"><i class="fa fa-question-circle"></i> Option</label>
		<select id="node-input-option">
			<option value="initialise">Initialise</option>
			<option value="refresh">Refresh Cookie</option>
			<option value="update">Update Cached State</option>
			<option value="reset">Reset</option>
			<option value="timer">Timer</option>
		</select>
	</div>
</script>

<script type="text/x-red" data-help-name="alexa-remote-init">
	<p>Enables control over Account Node intialisation.</p>
	<hr>
	<h3 id="inputs"><strong>Inputs</strong></h3>
	<ul>
		<li><strong>payload</strong>
			<ul>
				<li><code>&quot;stop&quot;</code> to stop the initialisation</li>
				<li><code>&quot;refresh&quot;</code> to refresh the cookie (only in proxy authentication mode)</li>
				<li>any other payload will initialise the account
					<ul>
						<li>if authentification mode is <em>proxy</em>, then you can send the output of the last
							initialisation for automatic initialisation</li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<hr>
	<h3 id="outputs"><strong>Outputs</strong></h3>
	<ul>
		<li><strong>payload</strong>
			<ul>
				<li>if authentication mode is <em>proxy</em> and on success this will be an object that you can
					send to this node later for automatic initialisation</li>
			</ul>
		</li>
	</ul>
	<hr>
	<h3 id="references"><strong>References</strong></h3>
	<ul>
		<li><a href="https://npmjs.com/package/node-red-contrib-alexa-remote2">npm</a> - the nodes npm repository</li>
		<li><a href="https://github.com/586837r/node-red-contrib-alexa-remote2">GitHub</a> - the nodes GitHub repository
		</li>
	</ul>
</script>

<script type="text/javascript">
	RED.nodes.registerType('alexa-remote-init', {
		category: 'alexa',
		color: '#6fbad8',
		defaults: {
			name: { value: '' },
			account: { value: '', type: 'alexa-remote-account', required: true },
			option: { value: 'initialise', required: true },
		},
		inputs: 1,
		outputs: 1,
		icon: 'alexa-remote-icon.png',
		paletteLabel: 'Alexa Init',
		label: function () {
			return this.name || "Alexa Init";
		},
		labelStyle: function () {
			return this.name ? "node_label_italic" : "";
		},
		/*
		button: {
            enabled: function() {
                return !this.changed;
			}
			
            onclick: function() {
                if (this.changed) {
                    return RED.notify(RED._("notification.warning", {message:RED._("notification.warnings.undeployedChanges")}),"warning");
				}
                $.ajax({
                    url: "alexa-remote-init/"+this.id,
                    type:"POST",
                    success: function(resp) {
                        RED.notify("Alexa Init Requested","success");
                    },
					error: function(jqXHR,textStatus,errorThrown) {
                        if (jqXHR.status == 404) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.not-deployed")}),"error");
                        } else if (jqXHR.status == 500) {
                            RED.notify(node._("common.notification.error",{message:node._("inject.errors.failed")}),"error");
                        } else if (jqXHR.status == 0) {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.no-response")}),"error");
                        } else {
                            RED.notify(node._("common.notification.error",{message:node._("common.notification.errors.unexpected",{status:jqXHR.status,message:textStatus})}),"error");
                        }
                    }
                }); 
			}
        }
		*/
	});
</script>